{% extends "base_workspace.html" %}
{% load i18n %}
{% load static %}
{% load dossier_tags %}

{% block javascript %}

<script src="{% static 'core/js/dossier_control.js' %}"></script>

<script language="javascript" type="text/javascript">

var MSG_STATUS_UNSAVED = "{% trans 'About to save changes...' %}";
var MSG_STATUS_SAVED = "{% trans 'Saved.' %}";
var MSG_STATUS_ERROR = "{% trans 'Could not save notes!' %}";

var fieldstate_css = {% autoescape off %}{% fieldstate_css %}{% endautoescape %}

var ISSUE_ID = {{ issue.id }};
var SETTING_AUTO_MONITOR = {% if user.userprofile.setting_auto_monitor %}true{% else %}false{% endif %};
var HAS_USEFUL_INFO = {% if statistic.has_useful_info %}true{% else %}false{% endif %};
var IS_MONITORED = {% if issue.monitor %}true{% else %}false{% endif %};

$(document).ready(function() {

    var prosearea_editor = document.querySelector('.prosearea-editor');

    // Initial focus.
    prosearea_editor.focus()

    // Unexpected clicks to focus editor.
    $(document).on('click', '[control="dossier-editor"]', function() {
        prosearea_editor.focus();
    });

});

</script>

{% endblock %}

{% block outside_container %}
    {% include 'core/stub/auto_monitor_notification.html' %}
{% endblock %}

{% block content %}

<div control="dossier-file-viewer">

    <iframe src="{% url 'parliament_review' parliament_num review.log_num %}" width="100%" height="100%"></iframe>

</div>

<div control="dossier-editor">

    <div class="panel panel-default">
        <div class="panel-body">
            <table style="width: 100%;">
                <tr>
                    <td>
                        <span class="label label-default" control="dossier-status"></span>
                    </td>
                    <td control="dossier-editor-control">
                        <button control="dossier-save" type="button" class="btn btn-default" disabled="true">{% trans 'Save' %}</button>
                        <button type="button" class="btn btn-default">{% trans 'Close' %}</button>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    {% include 'dossier/stub/dossier_buttons.html' %}

    <textarea class="prosearea-editor" data-dossier-id="{{ dossier.id }}" name="dossier_notes_{{ dossier.id }}">{{ dossier.notes }}</textarea>

<div>

{% endblock %}
